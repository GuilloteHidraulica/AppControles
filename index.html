<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUILLOTE HIDR√ÅULICA - Control Pro</title>
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
        :root {
            --metal: #2c3e50;
            --azul-hidraulico: #3498db;
            --naranja-alerta: #f39c12;
            --fondo: #0f0f0f;
            --led-on: #2ecc71;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--fondo);
            background-image: radial-gradient(#222 5%, transparent 5%);
            background-size: 20px 20px;
            color: #ecf0f1;
            margin: 0;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .panel-principal {
            width: 100%;
            max-width: 700px;
            background: linear-gradient(145deg, #1e272e, #2f3640);
            border: 4px solid #444;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 10px 10px 20px #000;
            position: relative;
        }

        .header {
            text-align: center;
            border-bottom: 3px double var(--azul-hidraulico);
            margin-bottom: 25px;
            padding-bottom: 10px;
        }

        .header h1 { margin: 0; color: var(--azul-hidraulico); letter-spacing: 3px; }

        .led {
            height: 10px; width: 10px; background: var(--led-on);
            border-radius: 50%; display: inline-block;
            box-shadow: 0 0 10px var(--led-on);
            margin-right: 10px;
        }

        .menu-grid { display: grid; gap: 20px; }

        .btn-industrial {
            background: #3d3d3d;
            color: white;
            padding: 20px;
            border: 2px solid #555;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: inset 0 0 5px #000;
            transition: 0.2s;
        }

        .btn-industrial:hover { background: var(--azul-hidraulico); border-color: #fff; }
        .btn-naranja { border-color: var(--naranja-alerta); color: var(--naranja-alerta); }
        .btn-naranja:hover { background: var(--naranja-alerta); color: white; }

        .vista { display: none; }
        .activa { display: block; animation: fadeIn 0.5s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .form-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }

        label { color: var(--naranja-alerta); font-size: 0.8em; font-weight: bold; display: block; margin-bottom: 5px; }

        input, textarea {
            width: 100%;
            padding: 12px;
            background: #111;
            border: 1px solid var(--azul-hidraulico);
            color: #2ecc71;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: monospace;
        }

        .tarjeta-registro {
            background: #222;
            border-left: 5px solid var(--azul-hidraulico);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 10px 10px 0;
        }

        .btn-volver { color: #888; cursor: pointer; text-decoration: underline; margin-bottom: 15px; display: inline-block; }
    </style>
</head>
<body>

<div class="panel-principal">
    
    <!-- MEN√ö -->
    <div id="vista-menu" class="vista activa">
        <div class="header">
            <h1><span class="led"></span>SISTEMA HIDR√ÅULICO</h1>
            <p>GUILLOTE HIDR√ÅULICA v3.0</p>
        </div>
        <div class="menu-grid">
            <button class="btn-industrial" onclick="navegar('vista-carga')">‚öôÔ∏è Cargar Datos M√°quina</button>
            <button class="btn-industrial btn-naranja" onclick="navegar('vista-archivo'); listarRegistros();">üìÇ Ver Archivo de Trabajos</button>
        </div>
    </div>

    <!-- CARGA DE DATOS -->
    <div id="vista-carga" class="vista">
        <span class="btn-volver" onclick="navegar('vista-menu')">‚Ü© VOLVER AL PANEL</span>
        <h2 style="color: var(--azul-hidraulico)">REGISTRO T√âCNICO</h2>
        <div class="form-container">
            <div class="full-width">
                <label>DIRECTOR DE PROYECTO / CLIENTE</label>
                <input type="text" id="inp-director">
            </div>
            <div>
                <label>MARCA</label>
                <input type="text" id="inp-marca">
            </div>
            <div>
                <label>MODELO</label>
                <input type="text" id="inp-modelo">
            </div>
            <div>
                <label>N¬∞ DE SERIE</label>
                <input type="text" id="inp-serie">
            </div>
            <div>
                <label>HORAS DE TRABAJO</label>
                <input type="number" id="inp-horas">
            </div>
            <div class="full-width">
                <label>TRABAJOS REALIZADOS</label>
                <textarea id="inp-realizados" rows="2"></textarea>
            </div>
            <div class="full-width">
                <label>TRABAJOS PENDIENTES</label>
                <textarea id="inp-pendientes" rows="2"></textarea>
            </div>
            <div class="full-width">
                <label>OBSERVACIONES</label>
                <textarea id="inp-obs" rows="2"></textarea>
            </div>
            <button class="btn-industrial full-width" onclick="guardarDatos()">üíæ PROCESAR Y GUARDAR</button>
        </div>
    </div>

    <!-- ARCHIVO -->
    <div id="vista-archivo" class="vista">
        <span class="btn-volver" onclick="navegar('vista-menu')">‚Ü© VOLVER AL PANEL</span>
        <h2 style="color: var(--naranja-alerta)">ARCHIVO DE REGISTROS</h2>
        <div id="lista-contenedor" style="max-height: 500px; overflow-y: auto; padding-right: 10px;"></div>
    </div>

</div>

<script>
    const { jsPDF } = window.jspdf;

    function navegar(id) {
        document.querySelectorAll('.vista').forEach(v => v.classList.remove('activa'));
        document.getElementById(id).classList.add('activa');
    }

    function guardarDatos() {
        const registro = {
            director: document.getElementById('inp-director').value,
            marca: document.getElementById('inp-marca').value,
            modelo: document.getElementById('inp-modelo').value,
            serie: document.getElementById('inp-serie').value,
            horas: document.getElementById('inp-horas').value,
            realizados: document.getElementById('inp-realizados').value,
            pendientes: document.getElementById('inp-pendientes').value,
            obs: document.getElementById('inp-obs').value,
            fecha: new Date().toLocaleString()
        };

        if(!registro.director || !registro.marca) {
            alert("Error: Faltan datos cr√≠ticos (Director y Marca)");
            return;
        }

        let db = JSON.parse(localStorage.getItem('gh_data')) || [];
        db.push(registro);
        localStorage.setItem('gh_data', JSON.stringify(db));

        alert("DATOS ALMACENADOS CORRECTAMENTE");
        limpiarInputs();
        navegar('vista-menu');
    }

    function listarRegistros() {
        const contenedor = document.getElementById('lista-contenedor');
        const db = JSON.parse(localStorage.getItem('gh_data')) || [];
        
        if(db.length === 0) {
            contenedor.innerHTML = "<p>ARCHIVO VAC√çO</p>";
            return;
        }

        contenedor.innerHTML = db.reverse().map((reg, idx) => `
            <div class="tarjeta-registro">
                <div style="font-size: 0.8em; color: #888;">${reg.fecha}</div>
                <div style="font-weight: bold; color: var(--azul-hidraulico); margin: 5px 0;">
                    ${reg.marca} ${reg.modelo} - SN: ${reg.serie}
                </div>
                <div style="font-size: 0.9em;">Resp: ${reg.director}</div>
                <button class="btn-industrial" style="padding: 5px 10px; margin-top:10px; width: 100%; font-size: 0.7em;" 
                    onclick="exportarPDF(${db.length - 1 - idx})">üìÑ GENERAR PDF</button>
            </div>
        `).join('');
    }

    function exportarPDF(index) {
        const data = JSON.parse(localStorage.getItem('gh_data'))[index];
        const doc = new jsPDF();

        doc.setFont("courier", "bold");
        doc.text("GUILLOTE HIDR√ÅULICA - REPORTE T√âCNICO", 15, 20);
        doc.setFont("courier", "normal");
        doc.setFontSize(10);
        doc.text(`FECHA: ${data.fecha}`, 15, 30);
        doc.line(15, 32, 195, 32);

        const campos = [
            ["DIRECTOR DE PROYECTO", data.director],
            ["MARCA", data.marca],
            ["MODELO", data.modelo],
            ["N¬∞ SERIE", data.serie],
            ["HORAS", data.horas],
            ["", ""],
            ["TRABAJOS REALIZADOS", data.realizados],
            ["TRABAJOS PENDIENTES", data.pendientes],
            ["OBSERVACIONES", data.obs]
        ];

        let y = 45;
        campos.forEach(c => {
            doc.setFont("courier", "bold");
            doc.text(`${c[0]}:`, 15, y);
            doc.setFont("courier", "normal");
            doc.text(`${c[1]}`, 70, y);
            y += 10;
        });

        doc.save(`Reporte_${data.marca}_${data.serie}.pdf`);
    }

    function limpiarInputs() {
        document.querySelectorAll('input, textarea').forEach(i => i.value = '');
    }
</script>

</body>
</html>
